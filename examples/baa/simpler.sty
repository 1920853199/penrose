Colors {
  Colors.black = rgba(0.0, 0.0, 0.0, 1.0)
  Colors.lightBlue = rgba(0.1, 0.1, 0.9, 0.2)
  Colors.lightYellow = rgba(0.95, 0.96, 0.92, 0.5)
}


forall Box b {
    b.padding = 50.0
    b.text = Text {
        string : b.label
        -- w : ?
        -- h : ?
    }
    b.shape = Rectangle {
        strokeWidth : 0
        -- w : b.text.w + 50.0  does not work
        -- h : b.text.h + 50.0
    }

    ensure contains(b.shape, b.text, 5.0)
    encourage equal(b.shape.w - b.padding, b.text.w)
    encourage equal(b.shape.h - b.padding, b.text.h)
    -- encourage equal (b.shape.h, b.text.h + b.padding) THIS DOESN'T WORK - why?
    -- encourage maximumSize(b.shape, b.text.w * b.text.h)
    encourage sameCenter(b.text, b.shape)
    LOCAL.layering = b.shape below b.text
}

Box `A` {
  override `A`.shape.x = -200.0
  override `A`.shape.y = 100.0
}

Box `B` {
  override `B`.shape.x = 300.0
  override `B`.shape.y = 100.0
}

Box `C` {
  override `C`.shape.x = 0.0
  override `C`.shape.y = 100.0
}


Box x; Box y {
   -- Try to make sure no labels overlap
   -- LOCAL.genRepelFn = encourage repel(x.shape, y.shape, 2.0) THIS DOESN'T WORK
   ensure disjoint (x.shape, y.shape)
}

Arr a
where To(X, Y, a) 
with Box X; Box Y {
    a.padding = 5.0
    a.pt1 = Circle{
        r : 1.0
        -- x : ?
        -- y : ?
        strokeWidth: 0.0
        color: Colors.black
    }
    a.line1 = Line{
        startX : X.shape.x + (X.shape.w) / 2.0
        startY : X.shape.y
        endX : a.pt1.x
        endY : a.pt1.y
        thickness : 2.0
        color : Colors.black
    }
    a.line2 = Line{
        startX : a.pt1.x
        startY : a.pt1.y
        endX : Y.shape.x - (Y.shape.w) / 2.0
        endY : Y.shape.y
        thickness : 2.0
        color : Colors.black
    }
    a.text = Text {
      x: ?
      y : ?
      string : a.label
      rotation : 0.0
    }

    -- a.labelFnMargin = ensure atDist(a.shape, a.text, 20.0)

    a.labelFn  = encourage centerLabel(a.line1, a.text, 1.0)
    a.llFn = encourage equal(lineLength(a.line1), lineLength(a.line2))
    encourage minLength(a.line1)
    encourage minLength(a.line2)
    -- ensure disjoint(a.pt1, X.shape)
    -- ensure disjoint(a.pt1, Y.shape)
}

  Arr a; Box B {
    ensure disjoint(B.shape, a.text)
    ensure disjoint(B.shape, a.line1)
    ensure disjoint(a.pt1, B.shape)
    ensure disjoint(B.shape, a.line2)
  }